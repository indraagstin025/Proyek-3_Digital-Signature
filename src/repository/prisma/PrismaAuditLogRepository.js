import { AuditLogRepository } from "../interface/AuditLogRepository.js";import CommonError from "../../errors/CommonError.js";export class PrismaAuditLogRepository {    constructor(prisma) {        this.prisma = prisma;    }    /**     * Mencatat aktivitas admin/sistem     */    async createLog(data) {        try {            return await this.prisma.auditLog.create({                data: {                    action: data.action,                    actorId: data.actorId,                    targetId: data.targetId,                    description: data.description,                    ipAddress: data.ipAddress,                    userAgent: data.userAgent                },            });        } catch (error) {            console.error("[AuditLog] Gagal menyimpan log ke DB:", error.message);            return null;        }    }    async findAllLogs(page = 1, limit = 10) {        try {            const skip = (page - 1) * limit;            // Jalankan 2 query secara paralel: Ambil Data & Hitung Total            const [data, total] = await this.prisma.$transaction([                this.prisma.auditLog.findMany({                    skip: skip,                    take: limit,                    orderBy: {createdAt: "desc"},                    include: {                        actor: {select: {id: true, name: true, email: true}},                    },                }),                this.prisma.auditLog.count()            ]);            return {                data,                meta: {                    total,                    page,                    limit,                    totalPages: Math.ceil(total / limit)                }            };        } catch (error) {            throw CommonError.DatabaseError(`Gagal mengambil audit log: ${error.message}`);        }    }}