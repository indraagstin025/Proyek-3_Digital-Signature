import { jest } from '@jest/globals';// Sesuaikan path import ini dengan lokasi file adminService.js Andaimport { AdminService } from "../../src/services/adminService.js";describe("AdminService", () => {    let adminService;    let mockAdminRepository;    beforeEach(() => {        // 1. Mock Repository        // Kita sesuaikan nama fungsinya dengan yang dipanggil di AdminService:        // findAllUsers, createUser, updateUserById, deleteUserById        mockAdminRepository = {            findAllUsers: jest.fn(),            createUser: jest.fn(),            updateUserById: jest.fn(),            deleteUserById: jest.fn(),        };        // 2. Inisialisasi Service        adminService = new AdminService(mockAdminRepository);    });    afterEach(() => {        jest.clearAllMocks();    });    // --- TEST 1: GET ALL USERS ---    describe("getAllUsers", () => {        it("Harus memanggil repository.findAllUsers dan mengembalikan hasilnya", async () => {            // Arrange            const mockUsers = [{ id: 1, name: "User A" }, { id: 2, name: "User B" }];            mockAdminRepository.findAllUsers.mockResolvedValue(mockUsers);            // Act            const result = await adminService.getAllUsers();            // Assert            expect(mockAdminRepository.findAllUsers).toHaveBeenCalled();            expect(result).toEqual(mockUsers);        });    });    // --- TEST 2: CREATE NEW USER (Logic Check) ---    describe("createNewUser", () => {        it("Harus mengubah email menjadi lowercase sebelum disimpan ke repository", async () => {            // Arrange            const rawUserData = {                email: "TEST@Example.COM", // Input huruf besar/campur                name: "Test User",                password: "password123",                isSuperAdmin: false            };            // Kita harapkan repository menerima email yang sudah dikecilkan            const expectedNormalizedData = {                ...rawUserData,                email: "test@example.com", // Harus lowercase            };            const mockCreatedUser = { id: 1, ...expectedNormalizedData };            mockAdminRepository.createUser.mockResolvedValue(mockCreatedUser);            // Act            const result = await adminService.createNewUser(rawUserData);            // Assert            // PENTING: Cek apakah fungsi repository dipanggil dengan data yang SUDAH dinormalisasi            expect(mockAdminRepository.createUser).toHaveBeenCalledWith(expectedNormalizedData);            expect(result).toEqual(mockCreatedUser);        });    });    // --- TEST 3: UPDATE USER ---    describe("updateUser", () => {        it("Harus memanggil repository.updateUserById dengan parameter yang benar", async () => {            // Arrange            const userId = "user-123";            const updateData = { name: "Updated Name" };            const mockUpdatedUser = { id: userId, ...updateData };            mockAdminRepository.updateUserById.mockResolvedValue(mockUpdatedUser);            // Act            const result = await adminService.updateUser(userId, updateData);            // Assert            expect(mockAdminRepository.updateUserById).toHaveBeenCalledWith(userId, updateData);            expect(result).toEqual(mockUpdatedUser);        });    });    // --- TEST 4: DELETE USER ---    describe("deleteUser", () => {        it("Harus memanggil repository.deleteUserById dengan ID yang benar", async () => {            // Arrange            const userId = "user-delete-id";            mockAdminRepository.deleteUserById.mockResolvedValue(true);            // Act            await adminService.deleteUser(userId);            // Assert            expect(mockAdminRepository.deleteUserById).toHaveBeenCalledWith(userId);        });    });});