// Sesuaikan path ini dengan lokasi file controller asli Andaimport { createAdminController } from "../../src/controllers/adminController.js";import { jest } from '@jest/globals';describe("AdminController", () => {    let mockAdminService;    let adminController;    let req;    let res;    let next;    // Setup sebelum setiap test berjalan    beforeEach(() => {        // 1. Mock Service: Definisikan method yang akan dipanggil oleh controller        mockAdminService = {            getAllUsers: jest.fn(),            createNewUser: jest.fn(),            updateUser: jest.fn(),            deleteUser: jest.fn(),        };        // 2. Inisialisasi Controller dengan Mock Service        adminController = createAdminController(mockAdminService);        // 3. Mock Response (res)        res = {            status: jest.fn().mockReturnThis(), // Agar bisa chaining: res.status().json()            json: jest.fn(),        };        // 4. Mock Next        next = jest.fn();    });    // --- TEST 1: GET ALL USERS ---    it("getAllUsers: Harus mengembalikan status 200 dan daftar user", async () => {        // ARRANGE        req = {}; // Tidak butuh body/params        const mockUsers = [            { id: 1, name: "User A", email: "a@test.com" },            { id: 2, name: "User B", email: "b@test.com" }        ];        // Mock service return array user        mockAdminService.getAllUsers.mockResolvedValue(mockUsers);        // ACT        await adminController.getAllUsers(req, res, next);        // ASSERT        expect(mockAdminService.getAllUsers).toHaveBeenCalled();        expect(res.status).toHaveBeenCalledWith(200);        expect(res.json).toHaveBeenCalledWith({            success: true,            count: 2,            data: mockUsers,        });    });    // --- TEST 2: CREATE USER ---    it("createUser: Harus memanggil service createNewUser dan return status 201", async () => {        // ARRANGE        req = {            body: {                email: "new@test.com",                password: "Pass",                name: "New User",                isSuperAdmin: false            }        };        const mockCreatedUser = { id: 3, ...req.body };        // Hapus password dari return mock biar mirip real world (opsional)        delete mockCreatedUser.password;        mockAdminService.createNewUser.mockResolvedValue(mockCreatedUser);        // ACT        await adminController.createUser(req, res, next);        // ASSERT        // Cek apakah service dipanggil dengan payload yang benar        expect(mockAdminService.createNewUser).toHaveBeenCalledWith({            email: "new@test.com",            password: "Pass",            name: "New User",            isSuperAdmin: false        });        expect(res.status).toHaveBeenCalledWith(201);        expect(res.json).toHaveBeenCalledWith({            success: true,            message: "User berhasil dibuat oleh admin.",            data: mockCreatedUser,        });    });    // --- TEST 3: UPDATE USER ---    it("updateUser: Harus memanggil service updateUser dan return status 200", async () => {        // ARRANGE        req = {            params: { userId: "user-123" },            body: { name: "Updated Name" }        };        const mockUpdatedUser = { id: "user-123", name: "Updated Name", email: "old@test.com" };        mockAdminService.updateUser.mockResolvedValue(mockUpdatedUser);        // ACT        await adminController.updateUser(req, res, next);        // ASSERT        expect(mockAdminService.updateUser).toHaveBeenCalledWith("user-123", { name: "Updated Name" });        expect(res.status).toHaveBeenCalledWith(200);        expect(res.json).toHaveBeenCalledWith({            success: true,            message: "User berhasil diperbaharui.",            data: mockUpdatedUser,        });    });    // --- TEST 4: DELETE USER ---    it("deleteUser: Harus memanggil service deleteUser dan return status 200", async () => {        // ARRANGE        req = {            params: { userId: "user-to-delete" }        };        mockAdminService.deleteUser.mockResolvedValue(); // Return void/undefined kalau sukses        // ACT        await adminController.deleteUser(req, res, next);        // ASSERT        expect(mockAdminService.deleteUser).toHaveBeenCalledWith("user-to-delete");        expect(res.status).toHaveBeenCalledWith(200);        expect(res.json).toHaveBeenCalledWith({            success: true,            message: "User dengan ID user-to-delete berhasil dihapus",        });    });});